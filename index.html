<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake by Newton</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Press Start 2P', cursive;
            background-color: #1a1a1a;
            color: #f0f0f0;
            overflow: hidden; /* Prevents scrollbars from appearing */
        }
        .game-container {
            max-width: 90vw;
            max-height: 90vh;
            aspect-ratio: 1;
        }
        canvas {
            background-color: #101010;
            border: 4px solid #333;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
        }
        .btn-control {
            transition: all 0.1s ease-in-out;
        }
        .btn-control:active {
            transform: scale(0.95);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }
        #message-box {
            transition: opacity 0.5s ease-in-out;
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-lg text-center mb-4">
        <div>
            <h1 class="text-4xl md:text-5xl font-bold text-green-400 tracking-wider">Snake</h1>
            <p class="text-sm text-gray-400 mt-2">by Newton</p>
        </div>
        <div class="flex justify-between items-center mt-4 text-lg md:text-xl px-2">
            <p>SCORE: <span id="score" class="font-bold text-yellow-300">0</span></p>
            <p>HIGH SCORE: <span id="high-score" class="font-bold text-yellow-300">0</span></p>
        </div>
    </div>

    <div class="relative game-container">
        <canvas id="gameCanvas" class="w-full h-full"></canvas>
        <div id="message-box" class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-70 rounded-lg">
            <h2 id="message-title" class="text-3xl md:text-4xl font-bold text-white mb-4">Ready?</h2>
            <button id="start-button" class="px-8 py-4 bg-green-500 text-black rounded-lg text-xl font-bold shadow-lg hover:bg-green-400 transition-colors">Start Game</button>
        </div>
    </div>

    <div class="mt-6 flex flex-col items-center">
        <div class="flex space-x-4">
            <button id="up-btn" class="btn-control bg-gray-700 p-4 rounded-lg shadow-md w-16 h-16 text-2xl">▲</button>
        </div>
        <div class="flex space-x-4 mt-4">
            <button id="left-btn" class="btn-control bg-gray-700 p-4 rounded-lg shadow-md w-16 h-16 text-2xl">◀</button>
            <button id="down-btn" class="btn-control bg-gray-700 p-4 rounded-lg shadow-md w-16 h-16 text-2xl">▼</button>
            <button id="right-btn" class="btn-control bg-gray-700 p-4 rounded-lg shadow-md w-16 h-16 text-2xl">▶</button>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');

            const scoreEl = document.getElementById('score');
            const highScoreEl = document.getElementById('high-score');
            const startButton = document.getElementById('start-button');
            const messageBox = document.getElementById('message-box');
            const messageTitle = document.getElementById('message-title');

            // --- Game Configuration ---
            const gridSize = 20; // The size of each square in the grid
            let canvasSize; // Will be set dynamically
            let tileCount; // Number of tiles in each row/column

            // --- Game State ---
            let snake = [];
            let food = {};
            let direction = 'right';
            let nextDirection = 'right';
            let score = 0;
            let highScore = localStorage.getItem('snakeHighScore') || 0;
            let gameOver = false;
            let gameInterval = null;
            let gameSpeed = 150; // Initial speed in ms

            // --- UI Elements ---
            const upBtn = document.getElementById('up-btn');
            const downBtn = document.getElementById('down-btn');
            const leftBtn = document.getElementById('left-btn');
            const rightBtn = document.getElementById('right-btn');

            // --- Setup and Initialization ---

            function resizeCanvas() {
                const container = canvas.parentElement;
                const size = Math.min(container.clientWidth, container.clientHeight);
                canvasSize = Math.floor(size / gridSize) * gridSize;
                canvas.width = canvasSize;
                canvas.height = canvasSize;
                tileCount = canvasSize / gridSize;
            }

            function initializeGame() {
                // Reset game state
                snake = [{ x: 10, y: 10 }];
                direction = 'right';
                nextDirection = 'right';
                score = 0;
                gameOver = false;
                gameSpeed = 150;
                scoreEl.textContent = score;
                highScoreEl.textContent = highScore;

                // Place initial food
                placeFood();

                // Hide message box and start game loop
                messageBox.style.opacity = '0';
                messageBox.style.pointerEvents = 'none';
                
                if (gameInterval) clearInterval(gameInterval);
                gameInterval = setInterval(gameLoop, gameSpeed);
            }
            
            // --- Game Loop ---

            function gameLoop() {
                if (gameOver) {
                    clearInterval(gameInterval);
                    showGameOver();
                    return;
                }
                
                direction = nextDirection;
                moveSnake();
                checkCollision();
                if (!gameOver) {
                    draw();
                }
            }

            // --- Drawing Functions ---

            function draw() {
                // Clear canvas
                ctx.fillStyle = '#101010';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Draw snake
                ctx.fillStyle = '#00ff00'; // Snake color
                snake.forEach((segment, index) => {
                    // Head has a different color
                    ctx.fillStyle = index === 0 ? '#33ff33' : '#00cc00';
                    ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize - 1, gridSize - 1);
                });

                // Draw food
                ctx.fillStyle = '#ff4136'; // Food color
                ctx.beginPath();
                ctx.arc(food.x * gridSize + gridSize / 2, food.y * gridSize + gridSize / 2, gridSize / 2 - 1, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            // --- Game Logic ---

            function moveSnake() {
                const head = { ...snake[0] }; // Copy the head

                switch (direction) {
                    case 'up': head.y--; break;
                    case 'down': head.y++; break;
                    case 'left': head.x--; break;
                    case 'right': head.x++; break;
                }

                snake.unshift(head); // Add new head

                // Check if snake ate food
                if (head.x === food.x && head.y === food.y) {
                    score++;
                    scoreEl.textContent = score;
                    if (score > highScore) {
                        highScore = score;
                        highScoreEl.textContent = highScore;
                        localStorage.setItem('snakeHighScore', highScore);
                    }
                    placeFood();
                    // Increase speed
                    clearInterval(gameInterval);
                    gameSpeed = Math.max(50, gameSpeed * 0.95); // Speed up, with a max speed
                    gameInterval = setInterval(gameLoop, gameSpeed);
                } else {
                    snake.pop(); // Remove tail
                }
            }

            function placeFood() {
                let foodX, foodY;
                do {
                    foodX = Math.floor(Math.random() * tileCount);
                    foodY = Math.floor(Math.random() * tileCount);
                } while (snake.some(segment => segment.x === foodX && segment.y === foodY));
                
                food = { x: foodX, y: foodY };
            }

            function checkCollision() {
                const head = snake[0];

                // Wall collision
                if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                    gameOver = true;
                    return;
                }

                // Self collision
                for (let i = 1; i < snake.length; i++) {
                    if (head.x === snake[i].x && head.y === snake[i].y) {
                        gameOver = true;
                        return;
                    }
                }
            }
            
            function showGameOver() {
                messageTitle.textContent = 'Game Over!';
                startButton.textContent = 'Play Again';
                messageBox.style.opacity = '1';
                messageBox.style.pointerEvents = 'auto';
            }

            // --- Event Listeners ---

            function handleKeyPress(e) {
                const key = e.key;
                if (key === 'ArrowUp' && direction !== 'down') nextDirection = 'up';
                else if (key === 'ArrowDown' && direction !== 'up') nextDirection = 'down';
                else if (key === 'ArrowLeft' && direction !== 'right') nextDirection = 'left';
                else if (key === 'ArrowRight' && direction !== 'left') nextDirection = 'right';
            }

            document.addEventListener('keydown', handleKeyPress);
            startButton.addEventListener('click', initializeGame);

            // Mobile controls
            upBtn.addEventListener('click', () => { if (direction !== 'down') nextDirection = 'up'; });
            downBtn.addEventListener('click', () => { if (direction !== 'up') nextDirection = 'down'; });
            leftBtn.addEventListener('click', () => { if (direction !== 'right') nextDirection = 'left'; });
            rightBtn.addEventListener('click', () => { if (direction !== 'left') nextDirection = 'right'; });
            
            window.addEventListener('resize', () => {
                const wasRunning = !!gameInterval && !gameOver;
                if (gameInterval) clearInterval(gameInterval);
                
                resizeCanvas();
                
                if (wasRunning) {
                    // If the game was running, redraw and restart the loop
                    draw();
                    gameInterval = setInterval(gameLoop, gameSpeed);
                } else {
                    // If the game was over or not started, just redraw the last state
                    draw();
                }
            });

            // --- Initial Setup ---
            resizeCanvas();
            highScoreEl.textContent = highScore;
            draw(); // Draw initial empty state
        });
    </script>

</body>
</html>
